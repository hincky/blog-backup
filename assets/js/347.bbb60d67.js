(window.webpackJsonp=window.webpackJsonp||[]).push([[347],{661:function(t,a,e){"use strict";e.r(a);var s=e(14),r=Object(s.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"logrotate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#logrotate"}},[t._v("#")]),t._v(" logrotate")]),t._v(" "),a("p",[t._v("系统日志进行轮转、压缩和删除")]),t._v(" "),a("h2",{attrs:{id:"补充说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#补充说明"}},[t._v("#")]),t._v(" 补充说明")]),t._v(" "),a("p",[a("strong",[t._v("logrotate命令")]),t._v(" 用于对系统日志进行轮转、压缩和删除，也可以将日志发送到指定邮箱。使用logrotate指令，可让你轻松管理系统所产生的记录文件。每个记录文件都可被设置成每日，每周或每月处理，也能在文件太大时立即处理。您必须自行编辑，指定配置文件，预设的配置文件存放在"),a("code",[t._v("/etc/logrotate.conf")]),t._v("文件中。")]),t._v(" "),a("h3",{attrs:{id:"语法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#语法"}},[t._v("#")]),t._v(" 语法")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("logrotate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("选项"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("参数"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h3",{attrs:{id:"选项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#选项"}},[t._v("#")]),t._v(" 选项")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("-?或--help：在线帮助；\n-d或--debug：详细显示指令执行过程，便于排错或了解程序执行的情况；\n-f或--force ：强行启动记录文件维护操作，纵使logrotate指令认为没有需要亦然；\n-s"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("状态文件"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("或--state"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("状态文件"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("：使用指定的状态文件；\n-v或--version：显示指令执行过程；\n-usage：显示指令基本用法。\n")])])]),a("h3",{attrs:{id:"参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参数"}},[t._v("#")]),t._v(" 参数")]),t._v(" "),a("p",[t._v("配置文件：指定lograote指令的配置文件。")]),t._v(" "),a("h3",{attrs:{id:"实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实例"}},[t._v("#")]),t._v(" 实例")]),t._v(" "),a("p",[t._v("crontab 会定时调用logrotate命令 在 "),a("code",[t._v("/etc/cron.daily/logrotate")]),t._v(" 文件中配置使用")]),t._v(" "),a("p",[t._v("logrotate的配置文件"),a("code",[t._v("/etc/logrotate.conf")]),t._v(" 定义引用"),a("code",[t._v("/etc/logrotate.d")]),t._v("目录下的一些自定义的log配置")]),t._v(" "),a("p",[t._v("在"),a("code",[t._v("/etc/logrotate.d")]),t._v("目录下创建任意后缀名的文件,即可使用对日志进行轮转")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("/tmp/log/log.txt\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    copytruncate\n    daily\n    rotate "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v("\n    missingok\n    ifempty\n    compress\n    noolddir\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("这个配置文件代表的意思是将"),a("code",[t._v("/tmp/log/log.txt")]),t._v("文件 进行轮转压缩")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("compress                 通过gzip 压缩转储以后的日志\nnocompress               不做gzip压缩处理\ncopytruncate             用于还在打开中的日志文件，把当前日志备份并截断；是先拷贝再清空的方式，拷贝和清空之间有一个时间差，可能会丢失部分日志数据。\nnocopytruncate 备份日志文件不过不截断\ncreate mode owner group  轮转时指定创建新文件的属性，如create 0777 nobody nobody\nnocreate                 不建立新的日志文件\ndelaycompress            和compress 一起使用时，转储的日志文件到下一次转储时才压缩\nnodelaycompress          覆盖 delaycompress 选项，转储同时压缩\nmissingok                如果日志丢失，不报错继续滚动下一个日志\nerrors address           专储时的错误信息发送到指定的Email 地址\nifempty                  即使日志文件为空文件也做轮转，这个是logrotate的缺省选项。\nnotifempty               当日志文件为空时，不进行轮转\nmail address             把转储的日志文件发送到指定的E-mail 地址\nnomail                   转储时不发送日志文件\nolddir directory         转储后的日志文件放入指定的目录，必须和当前日志文件在同一个文件系统\nnoolddir                 转储后的日志文件和当前日志文件放在同一个目录下\nsharedscripts            运行postrotate脚本，作用是在所有日志都轮转后统一执行一次脚本。如果没有配置这个，那么每个日志轮转后都会执行一次脚本\nprerotate                在logrotate转储之前需要执行的指令，例如修改文件的属性等动作；必须独立成行\npostrotate               在logrotate转储之后需要执行的指令，例如重新启动 (kill -HUP) 某个服务！必须独立成行\ndaily                    指定转储周期为每天\nweekly                   指定转储周期为每周\nmonthly                  指定转储周期为每月\nrotate count             指定日志文件删除之前转储的次数，0 指没有备份，5 指保留5 个备份\ndateext                  使用当期日期作为命名格式\ndateformat .%s           配合dateext使用，紧跟在下一行出现，定义文件切割后的文件名，必须配合dateext使用，只支持 %Y %m %d %s 这四个参数\nsize(或minsize) log-size 当日志文件到达指定的大小时才转储\n")])])]),a("h3",{attrs:{id:"注意事项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#注意事项"}},[t._v("#")]),t._v(" 注意事项")]),t._v(" "),a("p",[t._v("在"),a("code",[t._v("/etc/logrotate.d")]),t._v("目录下创建任意后缀名的文件")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("/tmp/log/log*\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    copytruncate\n    daily\n    rotate "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v("\n    missingok\n    ifempty\n    compress\n    noolddir\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("这种情况下，会将轮转过的log再重新轮转,因为轮转过后的文件名也是已log开头的")])])}),[],!1,null,null,null);a.default=r.exports}}]);