(window.webpackJsonp=window.webpackJsonp||[]).push([[583],{897:function(a,s,t){"use strict";t.r(s);var e=t(14),n=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"timedatectl"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#timedatectl"}},[a._v("#")]),a._v(" timedatectl")]),a._v(" "),s("p",[a._v("用于在 Linux 中设置或查询系统时间、日期和时区等配置。")]),a._v(" "),s("h2",{attrs:{id:"补充说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#补充说明"}},[a._v("#")]),a._v(" 补充说明")]),a._v(" "),s("p",[a._v("在 Linux 运维中，通常使用此命令来设置或更改当前的日期、时间和时区，或启用自动系统时钟与远程 NTP 服务器同步，以确保 Linux 系统始终保持正确的时间。")]),a._v(" "),s("h2",{attrs:{id:"概要"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#概要"}},[a._v("#")]),a._v(" 概要")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("timedatectl "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("OPTIONS"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("."),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" COMMAND "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\n")])])]),s("h2",{attrs:{id:"主要用途"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#主要用途"}},[a._v("#")]),a._v(" 主要用途")]),a._v(" "),s("ul",[s("li",[a._v("转换时间到选定的格式，默认为当前。")]),a._v(" "),s("li",[a._v("设置系统时间。")])]),a._v(" "),s("h2",{attrs:{id:"参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参数"}},[a._v("#")]),a._v(" 参数")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("Query or change system "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("time")]),a._v(" and "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("date")]),a._v(" settings.\n\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-h")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--help")]),a._v("                显示帮助信息。\n     "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--version")]),a._v("             显示软件包版本。\n     --no-pager            不用将输出通过管道传输到寻呼机（pager）。\n     --no-ask-password     不提示输入密码。\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-H")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--host")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("USER")]),a._v("@"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("HOST    在远程主机上操作\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-M")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--machine")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("CONTAINER   在本地容器上操作。\n     --adjust-system-clock 更改本地 RTC 模式时调整系统时钟。\n     "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--monitor")]),a._v("\t\t   监控systemd-timesyncd的状态\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--property")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("NAME       仅显示此名称的属性\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--all")]),a._v("\t\t   显示所有属性，包括空属性\n     "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--value")]),a._v("\t\t   显示属性时，只打印值\n\nCommands:\n  status                   显示当前的时间设置。\n  set-time TIME            设置系统时间。\n  set-timezone ZONE        设置系统时区。\n  list-timezones           显示已知时区。\n  set-local-rtc BOOL       控制 RTC 是否在当地时间。（BOOL 的值可以是 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" / "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v(" 或 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" / false）\n  set-ntp BOOL             启用或禁用网络时间同步。（BOOL 的值可以是 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" / "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v(" 或 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" / false）\n  timesync-status          显示 systemd-timesyncd 的状态。\n  show-timesync            显示 systemd-timesyncd 的属性。\n")])])]),s("h2",{attrs:{id:"例子"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#例子"}},[a._v("#")]),a._v(" 例子")]),a._v(" "),s("p",[a._v("显示系统当前时间和日期")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ timedatectl status\n      Local time: 五 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2022")]),a._v("-04-08 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("17")]),a._v(":06:40 CST\n  Universal time: 五 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2022")]),a._v("-04-08 09:06:40 UTC\n        RTC time: 五 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2022")]),a._v("-04-08 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("17")]),a._v(":04:02\n       Time zone: Asia/Shanghai "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("CST, +0800"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n     NTP enabled: n/a\nNTP synchronized: no\n RTC "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("local")]),a._v(" TZ: "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("yes")]),a._v("\n      DST active: n/a\n")])])]),s("p",[a._v("显示系统所有可用的时区")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ timedatectl show\nUnknown operation show\n$ timedatectl list-timezones\nAfrica/Abidjan\nAfrica/Accra\nAfrica/Addis_Ababa\n")])])]),s("p",[a._v("将本地时区从上海（Asia/Shanghai）设置为阿姆斯特丹（Europe/Amsterdam）")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ timedatectl set-timezone "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Europe/Amsterdam"')]),a._v("\n")])])]),s("p",[a._v("将本地时区设置为协调世界时（UTC）")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ timedatectl set-timezone UTC\n")])])]),s("p",[a._v("设置系统时间（格式：HH:MM:SS）")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ timedatectl set-time "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"07:25:46"')]),a._v("\n")])])]),s("p",[a._v("设置系统日期（格式：YYYY-MM-DD）")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ timedatectl set-time "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"2021-12-12"')]),a._v("\n")])])]),s("p",[a._v("如果只设置日期，那么时间将默认设置为 “00:00:00″（建议同时设置日期和时间）")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ timedatectl set-time "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"2021-12-12 07:25:46"')]),a._v("\n")])])]),s("p",[a._v("将硬件时钟（RTC）设置为本地时区（不建议，RTC 时钟统一使用 UTC 更恰当，避免在时区更改和夏令时调整方面产生各种问题）")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ timedatectl set-local-rtc "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n")])])]),s("p",[a._v("将硬件时钟（RTC）设置为协调世界时间（UTC）")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ timedatectl set-local-rtc "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("\n")])])]),s("p",[a._v("启用 NTP 自动时间同步")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ timedatectl set-ntp "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v("\n")])])]),s("p",[a._v("禁用 NTP 自动时间同步")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ timedatectl set-ntp "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("false")]),a._v("\n")])])]),s("p",[a._v("查看 systemd-timesyncd 服务的状态")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ timedatectl timesync-status\n       Server: "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("91.189")]),a._v(".94.4 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("ntp.ubuntu.com"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nPoll interval: 17min 4s "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("min: 32s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" max 34min 8s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n         Leap: normal\n      Version: "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),a._v("\n      Stratum: "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("\n    Reference: 91EECB0E\n    Precision: 1us "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("-23"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nRoot distance: "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("29")]),a._v(".922ms "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("max: 5s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n       Offset: +2.497ms\n        Delay: "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("199")]),a._v(".540ms\n       Jitter: "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),a._v(".834ms\n Packet count: "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("6")]),a._v("\n    Frequency: +13.039ppm\n")])])]),s("p",[s("code",[a._v("systemd-timedated")]),a._v(" 可能默认配置了谷歌的 NTP 服务器（如 time1.google.com），为了顺利完成网络时间同步，您可以编辑 "),s("code",[a._v("/etc/systemd/timesyncd.conf")]),a._v(" 文件添加自己的 NTP 服务器地址。")])])}),[],!1,null,null,null);s.default=n.exports}}]);