(window.webpackJsonp=window.webpackJsonp||[]).push([[320],{631:function(a,s,t){"use strict";t.r(s);var e=t(14),r=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"journalctl"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#journalctl"}},[a._v("#")]),a._v(" journalctl")]),a._v(" "),s("p",[a._v("检索 systemd 日志，是 CentOS 7 才有的工具。")]),a._v(" "),s("h3",{attrs:{id:"语法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#语法"}},[a._v("#")]),a._v(" 语法")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("journalctl "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("OPTIONS"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("."),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("MATCHES"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("."),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n")])])]),s("h3",{attrs:{id:"选项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#选项"}},[a._v("#")]),a._v(" 选项")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("Flags:\n "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--system")]),a._v("               "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 显示系统日志")]),a._v("\n "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--user")]),a._v("                 "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 显示当前用户的用户日志")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-M")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--machine")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("CONTAINER  "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 在本地容器上操作")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-S")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--since")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("DATE         "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 显示不早于指定日期的条目")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-U")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--until")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("DATE         "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 显示不晚于指定日期的条目")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--cursor")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("CURSOR      "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 显示从指定光标开始的条目")]),a._v("\n  --after-cursor"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("CURSOR "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 在指定光标后显示条目")]),a._v("\n  --show-cursor         "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 在所有条目之后打印光标")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-b")]),a._v(" --boot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("ID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("          "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 显示当前启动或指定启动")]),a._v("\n  --list-boots          "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 显示有关已记录引导的简洁信息")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-k")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dmesg")]),a._v("              "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 显示当前启动的内核消息日志")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--unit")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("UNIT          "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 显示指定单元的日志")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--identifier")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("STRING  "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 显示具有指定系统日志标识符的条目")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--priority")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("RANGE     "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 显示具有指定优先级的条目")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" --pager-end          "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 在pager中立即跳转到末尾")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--follow")]),a._v("             "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 关注期刊")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-n")]),a._v(" --lines"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("INTEGER"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("    "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 要显示的日志条目数")]),a._v("\n  --no-tail             "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 显示所有行，即使在跟随模式下")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--reverse")]),a._v("            "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 首先显示最新的条目")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-o")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--output")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("STRING      "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 更改日志输出模式 (short, short-iso,")]),a._v("\n                                   short-precise, short-monotonic, verbose,\n                                   export, json, json-pretty, json-sse, "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cat")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--utc")]),a._v("                   "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 以协调世界时 (UTC) 表示的时间")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-x")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--catalog")]),a._v("            "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 在可用的情况下添加消息说明")]),a._v("\n   --no-full            "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Ellipsize 字段")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--all")]),a._v("                "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 显示所有字段，包括长的和不可打印的")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-q")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--quiet")]),a._v("              "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 不显示特权警告")]),a._v("\n   --no-pager           "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 不要将输出通过管道传输到寻呼机")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--merge")]),a._v("              "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 显示所有可用期刊的条目")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-D")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--directory")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("PATH")]),a._v("     "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 显示目录中的日志文件")]),a._v("\n   "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--file")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("PATH")]),a._v("          "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 显示日志文件")]),a._v("\n   "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--root")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("ROOT          "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 对根目录下的目录文件进行操作")]),a._v("\n   "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--interval")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("TIME      "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 更改 FSS 密封键的时间间隔")]),a._v("\n   --verify-key"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("KEY     "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 指定FSS验证密钥")]),a._v("\n   "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--force")]),a._v("              "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 使用 --setup-keys 覆盖 FSS 密钥对 ")]),a._v("\n\nCommands:\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-h")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--help")]),a._v("              "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 显示此帮助文本")]),a._v("\n   "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--version")]),a._v("           "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 显示包版本")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-F")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--field")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("FIELD       "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 列出指定字段的所有值")]),a._v("\n   --new-id128         "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 生成新的 128 位 ID")]),a._v("\n   --disk-usage        "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 显示所有日志文件的总磁盘使用情况")]),a._v("\n   --vacuum-size"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("BYTES "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 将磁盘使用量减少到指定大小以下")]),a._v("\n   --vacuum-time"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("TIME  "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 删除早于指定日期的日志文件")]),a._v("\n   "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--flush")]),a._v("             "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 将所有日志数据从 /run 刷新到 /var")]),a._v("\n   "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--header")]),a._v("            "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 显示期刊头信息")]),a._v("\n   --list-catalog      "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 显示目录中的所有消息 ID")]),a._v("\n   --dump-catalog      "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 在消息目录中显示条目")]),a._v("\n   --update-catalog    "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 更新消息目录数据库")]),a._v("\n   --setup-keys        "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 生成新的 FSS 密钥对")]),a._v("\n   "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--verify")]),a._v("            "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 验证日志文件的一致性")]),a._v("\n")])])]),s("h3",{attrs:{id:"实例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实例"}},[a._v("#")]),a._v(" 实例")]),a._v(" "),s("p",[s("strong",[a._v("过滤输出")])]),a._v(" "),s("p",[s("code",[a._v("journalctl")]),a._v(" 可以根据特定字段过滤输出。如果过滤的字段比较多，需要较长时间才能显示出来。")]),a._v(" "),s("p",[a._v("示例：")]),a._v(" "),s("p",[a._v("显示本次启动后的所有日志：")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("journalctl "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-b")]),a._v("\n")])])]),s("p",[a._v("不过，一般大家更关心的不是本次启动后的日志，而是上次启动时的（例如，刚刚系统崩溃了）。可以使用 -b 参数：")]),a._v(" "),s("ul",[s("li",[s("code",[a._v("journalctl -b -0")]),a._v(" 显示本次启动的信息")]),a._v(" "),s("li",[s("code",[a._v("journalctl -b -1")]),a._v(" 显示上次启动的信息")]),a._v(" "),s("li",[s("code",[a._v("journalctl -b -2")]),a._v(" 显示上上次启动的信息 "),s("code",[a._v("journalctl -b -2")])])]),a._v(" "),s("p",[a._v("只显示错误、冲突和重要告警信息")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("journalctl "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("alert\n")])])]),s("p",[a._v("也可以使用数字， "),s("code",[a._v("journalctl -p 3..1")]),a._v("。如果使用单个 number/keyword，则 "),s("code",[a._v("journalctl -p 3")]),a._v(" - 还包括所有更高的优先级。")]),a._v(" "),s("p",[a._v("显示从某个日期 ( 或时间 ) 开始的消息:")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("journalctl "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--since")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"2012-10-30 18:17:16"')]),a._v("\n")])])]),s("p",[a._v("显示从某个时间 ( 例如 20分钟前 ) 的消息:")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("journalctl "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--since")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"20 min ago"')]),a._v("\n")])])]),s("p",[a._v("显示最新信息")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("journalctl "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v("\n")])])]),s("p",[a._v("显示特定程序的所有消息:")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("journalctl /usr/lib/systemd/systemd\n")])])]),s("p",[a._v("显示特定进程的所有消息:")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("journalctl "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("_PID")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n")])])]),s("p",[a._v("显示指定单元的所有消息：")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("journalctl "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" man-db.service\n")])])]),s("p",[a._v("显示内核环缓存消息r:")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("journalctl "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-k")]),a._v("\n")])])]),s("p",[s("strong",[a._v("手动清理日志")])]),a._v(" "),s("p",[s("code",[a._v("/var/log/journal")]),a._v(" 存放着日志, "),s("code",[a._v("rm")]),a._v(" 应该能工作. 或者使用 "),s("code",[a._v("journalctl")]),a._v(",")]),a._v(" "),s("p",[a._v("例如:")]),a._v(" "),s("p",[a._v("清理日志使总大小小于 100M:")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("journalctl --vacuum-size"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("100M\n")])])]),s("p",[a._v("清理最早两周前的日志.")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("journalctl --vacuum-time"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("2weeks\n")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);