(window.webpackJsonp=window.webpackJsonp||[]).push([[217],{531:function(t,a,s){"use strict";s.r(a);var e=s(14),n=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"ethtool"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ethtool"}},[t._v("#")]),t._v(" ethtool")]),t._v(" "),a("p",[t._v("显示或修改以太网卡的配置信息")]),t._v(" "),a("h2",{attrs:{id:"补充说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#补充说明"}},[t._v("#")]),t._v(" 补充说明")]),t._v(" "),a("p",[t._v("ethtool命令用于获取以太网卡的配置信息，或者修改这些配置。这个命令比较复杂，功能特别多。")]),t._v(" "),a("h3",{attrs:{id:"语法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#语法"}},[t._v("#")]),t._v(" 语法")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ethtool")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-a")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-c")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-g")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-i")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-k")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-r")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-S")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" ethX\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ethtool")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-A"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" ethX "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("autoneg on"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("off"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rx on"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("off"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("tx on"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("off"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ethtool")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-C"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" ethX "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("adaptive-rx on"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("off"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("adaptive-tx on"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("off"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rx-usecs N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rx-frames N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rx-usecs-irq N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rx-frames-irq N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("tx-usecs N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("tx-frames N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("tx-usecs-irq N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("tx-frames-irq N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("stats-block-usecs N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("pkt-rate-low N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rx-usecs-low N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rx-frames-low N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("tx-usecs-low N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("tx-frames-lowN"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("pkt-rate-high N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rx-usecs-high N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rx-frames-high N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("tx-usecs-high N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("tx-frames-high N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("sample-interval N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ethtool")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-G"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" ethX "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rx N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rx-mini N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rx-jumbo N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("tx N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ethtool")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" ethX "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("raw on"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("off"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("offset N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("length N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ethtool")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-E"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" ethX "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("magic N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("offset N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("value N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ethtool")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" ethX "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("rx on"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("off"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("tx on"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("off"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("sg on"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("off"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("tso on"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("off"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ethtool")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-p"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" ethX "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ethtool")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" ethX "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("offline"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("online"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ethtool")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" ethX "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("speed "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("duplex half"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("full"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("autoneg on"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("off"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("port tp"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("aui"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("bnc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("mii"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("phyad N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("xcvr internal"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("external"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("wol p"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("u"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("m"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("g"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("s"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("d"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("sopass xx:yy:zz:aa:bb:cc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("msglvl N"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("h3",{attrs:{id:"选项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#选项"}},[t._v("#")]),t._v(" 选项")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-a")]),t._v(" 查看网卡中 接收模块RX、发送模块TX和Autonegotiate模块的状态：启动on 或 停用off。\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-A")]),t._v(" 修改网卡中 接收模块RX、发送模块TX和Autonegotiate模块的状态：启动on 或 停用off。\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-c")]),t._v(" display the Coalesce information of the specified ethernet card。\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-C")]),t._v(" Change the Coalesce setting of the specified ethernet card。\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-g")]),t._v(" Display the rx/tx ring parameter information of the specified ethernet card。\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-G")]),t._v(" change the rx/tx ring setting of the specified ethernet card。\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-i")]),t._v(" 显示网卡驱动的信息，如驱动的名称、版本等。\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" 显示register dump信息, 部分网卡驱动不支持该选项。\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v(" 显示EEPROM dump信息，部分网卡驱动不支持该选项。\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-E")]),t._v(" 修改网卡EEPROM byte。\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-k")]),t._v(" 显示网卡Offload参数的状态：on 或 off，包括rx-checksumming、tx-checksumming等。\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-K")]),t._v(" 修改网卡Offload参数的状态。\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" 用于区别不同ethX对应网卡的物理位置，常用的方法是使网卡port上的led不断的闪；N指示了网卡闪的持续时间，以秒为单位。\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-r")]),t._v(" 如果auto-negotiation模块的状态为on，则restarts auto-negotiation。\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-S")]),t._v(" 显示NIC- and driver-specific 的统计参数，如网卡接收/发送的字节数、接收/发送的广播包个数等。\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v(" 让网卡执行自我检测，有两种模式：offline or online。\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-s")]),t._v(" 修改网卡的部分配置，包括网卡速度、单工/全双工模式、mac地址等。\n")])])]),a("h3",{attrs:{id:"数据来源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据来源"}},[t._v("#")]),t._v(" 数据来源")]),t._v(" "),a("p",[t._v("Ethtool命令显示的信息来源于网卡驱动层，即TCP/ip协议的链路层。该命令在Linux内核中实现的逻辑层次为：")]),t._v(" "),a("p",[t._v("最重要的结构体"),a("code",[t._v("struct ethtool_ops")]),t._v("，该结构体成员为用于显示或修改以太网卡配置的一系列函数指针，见下表中的第二列。")]),t._v(" "),a("p",[t._v("网卡驱动负责实现（部分）这些函数，并将其封装入"),a("code",[t._v("ethtool_ops")]),t._v("结构体，为网络核心层提供统一的调用接口。因此，不同的网卡驱动会给应用层返回不同的信息。"),a("code",[t._v("Ethtool命令选项")]),t._v("、"),a("code",[t._v("struct ethtool_ops成员函数")]),t._v("、"),a("code",[t._v("Ethtool命令显示参数的来源")]),t._v("，三者间的对应关系如下表所示：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("命令选项")]),t._v(" "),a("th",[t._v("struct ethtool_ops成员函数")]),t._v(" "),a("th",[t._v("Ethtool命令显示参数的来源（以网卡驱动BNX2为例）")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("无 -s")]),t._v(" "),a("td",[t._v("get_settingsget_wol get_msglevel get_link set_settings set_wol set_msglevel")]),t._v(" "),a("td",[t._v("从网卡寄存器中获得网卡速度等信息，可配置。")])]),t._v(" "),a("tr",[a("td",[t._v("-a -A")]),t._v(" "),a("td",[t._v("get_pauseparam set_pauseparam")]),t._v(" "),a("td",[t._v("从网卡寄存器中获得Autonegotiate/RX/TX模块的状态：on oroff，可配置。")])]),t._v(" "),a("tr",[a("td",[t._v("-c -C")]),t._v(" "),a("td",[t._v("get_coalesceset_coalesce")]),t._v(" "),a("td",[t._v("从网卡寄存器中获得coalescing参数：TX/RX一个数据包后，推迟发生TX/RX中断的时间(us)/数据包个数。—减小该值可以提高网卡的响应时间。 当rx-usecs&rx-frames同时被设为0时，RX中断停止。 当tx-usecs&tx-frames同时被设为0时，TX中断停止。")])]),t._v(" "),a("tr",[a("td",[t._v("-g -G")]),t._v(" "),a("td",[t._v("get_ringparam set_ringparam")]),t._v(" "),a("td",[t._v("除当前TX/RX ring的值（从网卡寄存器中读取得到，可配置）外，其它为网卡bnx2自己固定的信息。")])]),t._v(" "),a("tr",[a("td",[t._v("-k -K")]),t._v(" "),a("td",[t._v("get_rx_csumget_tx_csum get_sg get_tso set_rx_csum set_tx_csum set_sg set_tso")]),t._v(" "),a("td",[t._v("显示信息从保存该状态的变量中读取得到，没有对应的寄存器。因此，TX/RX校验等模块一直处于on状态，实际上是无法修改的。")])]),t._v(" "),a("tr",[a("td",[t._v("-i")]),t._v(" "),a("td",[t._v("get_drvinfo[self_test_count, get_stats_coun,t get_regs_len, get_eeprom_len]")]),t._v(" "),a("td",[t._v("网卡bnx2自己固定的信息，如： ——————driver: bnx2 version: 1.4.30 firmware-version: 1.8.0.5 bus-info: 0000:09:00.0 ———————————–")])]),t._v(" "),a("tr",[a("td",[t._v("-d")]),t._v(" "),a("td",[t._v("get_drvinfoget_regs")]),t._v(" "),a("td",[t._v("不支持，即bnx2中没有实现函数get_regs。")])]),t._v(" "),a("tr",[a("td",[t._v("-e -E")]),t._v(" "),a("td",[t._v("get_eepromset_eeprom")]),t._v(" "),a("td",[t._v("不支持，即bnx2中没有实现函数get_eeprom。")])]),t._v(" "),a("tr",[a("td",[t._v("-r")]),t._v(" "),a("td",[t._v("nway_reset")]),t._v(" "),a("td",[t._v("配置网卡MII_BMCR寄存器，重启Auto negotiation模块。")])]),t._v(" "),a("tr",[a("td",[t._v("-p")]),t._v(" "),a("td",[t._v("phys_id")]),t._v(" "),a("td",[t._v("配置网卡BNX2_EMAC_LED寄存器，实现LED闪功能。")])]),t._v(" "),a("tr",[a("td",[t._v("-t")]),t._v(" "),a("td",[t._v("self_test")]),t._v(" "),a("td",[t._v("通过配置网卡寄存器，逐一测试网卡的硬件模块：registers，memory，loopback，Link stat，interrupt。")])]),t._v(" "),a("tr",[a("td",[t._v("-S")]),t._v(" "),a("td",[t._v("get_ethtool_stats")]),t._v(" "),a("td",[t._v("显示信息来源于网卡驱动中的结构体变量stats_blk。（网卡通过DMA方式，将寄存器BNX2_HC_STATISTICS _ADDR_L和BNX2_HC_STATISTICS_ADDR_H中的数据实时地读取到结构体变量struct statistics_block *stats_blk中。） —显示的数据都是从网卡寄存器中统计得到的，各项的含义需查询网卡（芯片）手册。")])])])]),t._v(" "),a("p",[t._v("由上可见，ethtool命令用于显示/配置网卡硬件（寄存器）。")]),t._v(" "),a("h3",{attrs:{id:"实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实例"}},[t._v("#")]),t._v(" 实例")]),t._v(" "),a("p",[t._v("查看机器上网卡的速度：百兆还是千兆，请输入：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("ethool eth0\n")])])]),a("p",[t._v("操作完毕后，输出信息中"),a("code",[t._v("Speed:")]),t._v("这一项就指示了网卡的速度。停止网卡的发送模块TX，请输入：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ethtool")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-A")]),t._v(" tx off eth0\n")])])]),a("p",[t._v("操作完毕后，可输入"),a("code",[t._v("ethtool -a eth0")]),t._v("，查看tx模块是否已被停止。查看网卡eth0采用了何种驱动，请输入：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ethtool")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-i")]),t._v(" eth0\n")])])]),a("p",[t._v("操作完毕后，显示 driver: bnx2；version: 1.4.30 等信息。关闭网卡对收到的数据包的校验功能，请输入：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ethtool")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-K")]),t._v(" eth0 rx off\n")])])]),a("p",[t._v("操作完毕后，可输入"),a("code",[t._v("ethtool –k eth0")]),t._v("，查看校验功能是否已被停止。如果机器上安装了两块网卡，那么eth0对应着哪块网卡呢？输入：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ethtool")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" eth0 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("\n")])])]),a("p",[t._v("操作完毕后，看哪块网卡的led灯在闪，eth0就对应着哪块网卡。查看网卡，在接收/发送数据时，有没有出错？请输入：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ethtool")]),t._v(" –S eth0\n")])])]),a("p",[t._v("将千兆网卡的速度降为百兆，请输入：")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ethtool")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-s")]),t._v(" eth0 speed "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("\n")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);