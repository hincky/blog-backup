(window.webpackJsonp=window.webpackJsonp||[]).push([[249],{562:function(t,s,a){"use strict";a.r(s);var n=a(14),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"gdb"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#gdb"}},[t._v("#")]),t._v(" gdb")]),t._v(" "),s("p",[t._v("功能强大的程序调试器")]),t._v(" "),s("h2",{attrs:{id:"补充说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#补充说明"}},[t._v("#")]),t._v(" 补充说明")]),t._v(" "),s("p",[s("strong",[t._v("gdb命令")]),t._v(" 包含在GNU的gcc开发套件中，是功能强大的程序调试器。GDB中的命令固然很多，但我们只需掌握其中十个左右的命令，就大致可以完成日常的基本的程序调试工作。")]),t._v(" "),s("h3",{attrs:{id:"语法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#语法"}},[t._v("#")]),t._v(" 语法")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("选项"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("参数"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"选项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#选项"}},[t._v("#")]),t._v(" 选项")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("-cd：设置工作目录；\n-q：安静模式，不打印介绍信息和版本信息；\n-d：添加文件查找路径；\n-x：从指定文件中执行GDB指令；\n-s：设置读取的符号表文件。\n")])])]),s("table",[s("thead",[s("tr",[s("th",[t._v("命令")]),t._v(" "),s("th",[t._v("解释")]),t._v(" "),s("th",[t._v("示例")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("file <文件名>")]),t._v(" "),s("td",[t._v("加载被调试的可执行程序文件。"),s("br"),t._v(" 因为一般都在被调试程序所在目录下执行GDB，因而文本名不需要带路径。")]),t._v(" "),s("td",[t._v("(gdb) file gdb-sample")])]),t._v(" "),s("tr",[s("td",[t._v("r")]),t._v(" "),s("td",[t._v("Run的简写，运行被调试的程序。"),s("br"),t._v(" 如果此前没有下过断点，则执行完整个程序；如果有断点，则程序暂停在第一个可用断点处。")]),t._v(" "),s("td",[t._v("(gdb) r")])]),t._v(" "),s("tr",[s("td",[t._v("c")]),t._v(" "),s("td",[t._v("Continue的简写，继续执行被调试程序，直至下一个断点或程序结束。")]),t._v(" "),s("td",[t._v("(gdb) c")])]),t._v(" "),s("tr",[s("td",[t._v("b <行号>"),s("br"),t._v("b <函数名称>"),s("br"),t._v("b *<函数名称>"),s("br"),t._v("b *<代码地址> d [编号]")]),t._v(" "),s("td",[t._v("b: Breakpoint的简写，设置断点。两可以使用“行号”“函数名称”“执行地址”等方式指定断点位置。 "),s("br"),t._v(" 其中在函数名称前面加“*”符号表示将断点设置在“由编译器生成的prolog代码处”。如果不了解汇编，可以不予理会此用法。 d: Delete breakpoint的简写，删除指定编号的某个断点，或删除所有断点。断点编号从1开始递增。")]),t._v(" "),s("td",[t._v("(gdb) b 8(gdb) b main "),s("br"),t._v(" (gdb) b *main "),s("br"),t._v(" (gdb) b *0x804835c (gdb) d")])]),t._v(" "),s("tr",[s("td",[t._v("s, n")]),t._v(" "),s("td",[t._v("s: 执行一行源程序代码，如果此行代码中有函数调用，则进入该函数；"),s("br"),t._v(" n: 执行一行源程序代码，此行代码中的函数调用也一并执行。 s 相当于其它调试器中的“Step Into (单步跟踪进入)”；"),s("br"),t._v(" n 相当于其它调试器中的“Step Over (单步跟踪)”。 这两个命令必须在有源代码调试信息的情况下才可以使用（GCC编译时使用“-g”参数）。")]),t._v(" "),s("td",[t._v("(gdb) s "),s("br"),t._v(" (gdb) n")])]),t._v(" "),s("tr",[s("td",[t._v("si, ni")]),t._v(" "),s("td",[t._v("si命令类似于s命令，ni命令类似于n命令。所不同的是，这两个命令（si/ni）所针对的是汇编指令，而s/n针对的是源代码。")]),t._v(" "),s("td",[t._v("(gdb) si "),s("br"),t._v("(gdb) ni")])]),t._v(" "),s("tr",[s("td",[t._v("p <变量名称>")]),t._v(" "),s("td",[t._v("Print的简写，显示指定变量（临时变量或全局变量）的值。")]),t._v(" "),s("td",[t._v("(gdb) p i "),s("br"),t._v(" (gdb) p nGlobalVar")])]),t._v(" "),s("tr",[s("td",[t._v("display ... undisplay <编号>")]),t._v(" "),s("td",[t._v("display，设置程序中断后欲显示的数据及其格式。 "),s("br"),t._v(" 例如，如果希望每次程序中断后可以看到即将被执行的下一条汇编指令，可以使用命令 "),s("br"),t._v(" “display /i $pc” "),s("br"),t._v(" 其中 $pc 代表当前汇编指令，/i 表示以十六进行显示。当需要关心汇编代码时，此命令相当有用。 undispaly，取消先前的display设置，编号从1开始递增。")]),t._v(" "),s("td",[t._v("(gdb) display /i $pc (gdb) undisplay 1")])]),t._v(" "),s("tr",[s("td",[t._v("i")]),t._v(" "),s("td",[t._v("info的简写，用于显示各类信息，详情请查阅“help i”。")]),t._v(" "),s("td",[t._v("(gdb) i r")])]),t._v(" "),s("tr",[s("td",[t._v("q")]),t._v(" "),s("td",[t._v("Quit的简写，退出GDB调试环境。")]),t._v(" "),s("td",[t._v("(gdb) q")])]),t._v(" "),s("tr",[s("td",[t._v("help [命令名称]")]),t._v(" "),s("td",[t._v("GDB帮助命令，提供对GDB名种命令的解释说明。"),s("br"),t._v(" 如果指定了“命令名称”参数，则显示该命令的详细说明；如果没有指定参数，则分类显示所有GDB命令，供用户进一步浏览和查询。")]),t._v(" "),s("td",[t._v("(gdb) help")])])])]),t._v(" "),s("h3",{attrs:{id:"参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参数"}},[t._v("#")]),t._v(" 参数")]),t._v(" "),s("p",[t._v("文件：二进制可执行程序。")]),t._v(" "),s("h3",{attrs:{id:"实例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实例"}},[t._v("#")]),t._v(" 实例")]),t._v(" "),s("p",[t._v("以下是linux下dgb调试的一个实例，先给出一个示例用的小程序，C语言代码：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#include <stdio.h>")]),t._v("\nint nGlobalVar "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nint tempFunction"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("int a, int b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    printf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tempFunction is called, a = %d, b = %d /n"')]),t._v(", a, b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a + b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nint "),s("span",{pre:!0,attrs:{class:"token function-name function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    int n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        n "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        n++"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        n--"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        nGlobalVar "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        nGlobalVar -"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    printf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"n = %d, nGlobalVar = %d /n"')]),t._v(", n, nGlobalVar"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        n "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" tempFunction"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    printf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"n = %d"')]),t._v(", n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("请将此代码复制出来并保存到文件 gdb-sample.c 中，然后切换到此文件所在目录，用GCC编译之：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("gcc gdb-sample.c "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-o")]),t._v(" gdb-sample "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-g")]),t._v("\n")])])]),s("p",[t._v("在上面的命令行中，使用 -o 参数指定了编译生成的可执行文件名为 gdb-sample，使用参数 -g 表示将源代码信息编译到可执行文件中。如果不使用参数 -g，会给后面的GDB调试造成不便。当然，如果我们没有程序的源代码，自然也无从使用 -g 参数，调试/跟踪时也只能是汇编代码级别的调试/跟踪。")]),t._v(" "),s("p",[t._v("下面“gdb”命令启动GDB，将首先显示GDB说明，不管它：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("GNU gdb Red Hat Linux "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(".3post-0.20021129.18rh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nCopyright "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2003")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("free")]),t._v(" Software Foundation, Inc.\nGDB is "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("free")]),t._v(" software, covered by the GNU General Public License, and you are\nwelcome to change it and/or distribute copies of it under certain conditions.\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("type")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"show copying"')]),t._v(" to see the conditions.\nThere is absolutely no warranty "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" GDB. Type "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"show warranty"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" details.\nThis GDB was configured as "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"i386-redhat-linux-gnu"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("上面最后一行“(gdb)”为GDB内部命令引导符，等待用户输入GDB命令。")]),t._v(" "),s("p",[t._v("下面使用“file”命令载入被调试程序 gdb-sample（这里的 gdb-sample 即前面 GCC 编译输出的可执行文件）：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v(" gdb-sample\nReading symbols from gdb-sample"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".done.\n")])])]),s("p",[t._v("上面最后一行提示已经加载成功。")]),t._v(" "),s("p",[t._v("下面使用“r”命令执行（Run）被调试文件，因为尚未设置任何断点，将直接执行到程序结束：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" r\nStarting program: /home/liigo/temp/test_jmp/test_jmp/gdb-sample\nn "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(", nGlobalVar "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("88")]),t._v("\ntempFunction is called, a "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(", b "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\nn "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\nProgram exited normally.\n")])])]),s("p",[t._v("下面使用“b”命令在 main 函数开头设置一个断点（Breakpoint）：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" b main\nBreakpoint "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" at 0x804835c: "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v(" gdb-sample.c, line "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(".\n")])])]),s("p",[t._v("上面最后一行提示已经成功设置断点，并给出了该断点信息：在源文件 gdb-sample.c 第19行处设置断点；这是本程序的第一个断点（序号为1）；断点处的代码地址为 0x804835c（此值可能仅在本次调试过程中有效）。回过头去看源代码，第19行中的代码为“n = 1”，恰好是 main 函数中的第一个可执行语句（前面的“int n;”为变量定义语句，并非可执行语句）。")]),t._v(" "),s("p",[t._v("再次使用“r”命令执行（Run）被调试程序：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" r\nStarting program: /home/liigo/temp/gdb-sample\n\nBreakpoint "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(", main "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" at gdb-sample.c:19\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" n "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("程序中断在gdb-sample.c第19行处，即main函数是第一个可执行语句处。")]),t._v(" "),s("p",[t._v("上面最后一行信息为：下一条将要执行的源代码为“n = 1;”，它是源代码文件gdb-sample.c中的第19行。")]),t._v(" "),s("p",[t._v("下面使用“s”命令（Step）执行下一行代码（即第19行“n = 1;”）：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" s\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" n++"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("上面的信息表示已经执行完“n = 1;”，并显示下一条要执行的代码为第20行的“n++;”。")]),t._v(" "),s("p",[t._v("既然已经执行了“n = 1;”，即给变量 n 赋值为 1，那我们用“p”命令（Print）看一下变量 n 的值是不是 1 ：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" p n\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n")])])]),s("p",[t._v("果然是 1。（$1大致是表示这是第一次使用“p”命令——再次执行“p n”将显示“$2 = 1”——此信息应该没有什么用处。）")]),t._v(" "),s("p",[t._v("下面我们分别在第26行、tempFunction 函数开头各设置一个断点（分别使用命令“b 26”“b tempFunction”）：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" b "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("26")]),t._v("\nBreakpoint "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" at 0x804837b: "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v(" gdb-sample.c, line "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("26")]),t._v(".\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" b tempFunction\nBreakpoint "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" at 0x804832e: "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v(" gdb-sample.c, line "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v(".\n")])])]),s("p",[t._v("使用“c”命令继续（Continue）执行被调试程序，程序将中断在第二 个断点（26行），此时全局变量 nGlobalVar 的值应该是 88；再一次执行“c”命令，程序将中断于第三个断点（12行，tempFunction 函数开头处），此时tempFunction 函数的两个参数 a、b 的值应分别是 1 和 2：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" c\nContinuing.\n\nBreakpoint "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(", main "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" at gdb-sample.c:26\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("26")]),t._v(" printf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"n = %d, nGlobalVar = %d /n"')]),t._v(", n, nGlobalVar"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" p nGlobalVar\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$2")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("88")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" c\nContinuing.\nn "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(", nGlobalVar "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("88")]),t._v("\n\nBreakpoint "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(", tempFunction "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("b")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" at gdb-sample.c:12\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v(" printf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tempFunction is called, a = %d, b = %d /n"')]),t._v(", a, b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" p a\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$3")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" p b\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$4")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n")])])]),s("p",[t._v("上面反馈的信息一切都在我们预料之中~~")]),t._v(" "),s("p",[t._v("再一次执行“c”命令（Continue），因为后面再也没有其它断点，程序将一直执行到结束：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" c\nContinuing.\ntempFunction is called, a "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(", b "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\nn "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\nProgram exited normally.\n")])])]),s("p",[t._v("有时候需要看到编译器生成的汇编代码，以进行汇编级的调试或跟踪，又该如何操作呢？")]),t._v(" "),s("p",[t._v("这就要用到display命令“display /i $pc”了（此命令前面已有详细解释）：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" display /i "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$pc")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("此后程序再中断时，就可以显示出汇编代码了：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" r\nStarting program: /home/liigo/temp/test_jmp/test_jmp/gdb-sample\n\nBreakpoint "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(", main "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" at gdb-sample.c:19\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" n "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": x/i "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$pc")]),t._v(" 0x804835c "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("main+1"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("6")]),t._v(">")]),t._v(": movl "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$0x1")]),t._v(",0xfffffffc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("%ebp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("看到了汇编代码，“n = 1;”对应的汇编代码是“movl $0x1,0xfffffffc(%ebp)”。")]),t._v(" "),s("p",[t._v("并且以后程序每次中断都将显示下一条汇编指定（“si”命令用于执行一条汇编代码——区别于“s”执行一行C代码）：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" si\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" n++"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": x/i "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$pc")]),t._v(" 0x8048363 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("main+2"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("3")]),t._v(">")]),t._v(": lea 0xfffffffc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("%ebp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(",%eax\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" si\n0x08048366 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" n++"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": x/i "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$pc")]),t._v(" 0x8048366 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("main+2"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("6")]),t._v(">")]),t._v(": incl "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("%eax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" si\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(" n--"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": x/i "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$pc")]),t._v(" 0x8048368 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("main+2"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("8")]),t._v(">")]),t._v(": lea 0xfffffffc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("%ebp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(",%eax\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" si\n0x0804836b "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(" n--"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": x/i "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$pc")]),t._v(" 0x804836b "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("main+3"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("1")]),t._v(">")]),t._v(": decl "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("%eax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" si\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("23")]),t._v(" nGlobalVar "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": x/i "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$pc")]),t._v(" 0x804836d "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("main+3"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("3")]),t._v(">")]),t._v(": addl "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$0x64")]),t._v(",0x80494fc\n")])])]),s("p",[t._v("接下来我们试一下命令“b *<函数名称>”。")]),t._v(" "),s("p",[t._v("为了更简明，有必要先删除目前所有断点（使用“d”命令——Delete breakpoint）：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" d\nDelete all breakpoints? "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("y or n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" y\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("当被询问是否删除所有断点时，输入“y”并按回车键即可。")]),t._v(" "),s("p",[t._v("下面使用命令“b *main”在 main 函数的 prolog 代码处设置断点（prolog、epilog，分别表示编译器在每个函数的开头和结尾自行插入的代码）：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" b *main\nBreakpoint "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" at 0x804834c: "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v(" gdb-sample.c, line "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(".\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" r\nThe program being debugged has been started already.\nStart it from the beginning? "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("y or n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" y\nStarting program: /home/liigo/temp/test_jmp/test_jmp/gdb-sample\n\nBreakpoint "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(", main "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" at gdb-sample.c:17\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": x/i "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$pc")]),t._v(" 0x804834c "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("main"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(": push %ebp\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" si\n0x0804834d "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": x/i "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$pc")]),t._v(" 0x804834d "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("main+"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("1")]),t._v(">")]),t._v(": mov %esp,%ebp\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" si\n0x0804834f "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" main "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" at gdb-sample.c:17\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": x/i "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$pc")]),t._v(" 0x804834f "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("main+"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("3")]),t._v(">")]),t._v(": sub "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$0x8")]),t._v(",%esp\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" si\n0x08048352 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": x/i "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$pc")]),t._v(" 0x8048352 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("main+"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("6")]),t._v(">")]),t._v(": and "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$0xfffffff0")]),t._v(",%esp\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" si\n0x08048355 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": x/i "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$pc")]),t._v(" 0x8048355 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("main+"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("9")]),t._v(">")]),t._v(": mov "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$0x0")]),t._v(",%eax\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" si\n0x0804835a "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": x/i "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$pc")]),t._v(" 0x804835a "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("main+1"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("4")]),t._v(">")]),t._v(": sub %eax,%esp\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" si\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" n "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": x/i "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$pc")]),t._v(" 0x804835c "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("main+1"),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("6")]),t._v(">")]),t._v(": movl "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$0x1")]),t._v(",0xfffffffc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("%ebp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("此时可以使用“i r”命令显示寄存器中的当前值———“i r”即“Infomation Register”：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" i r\neax 0xbffff6a4 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-1073744220")]),t._v("\necx 0x42015554 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1107383636")]),t._v("\nedx 0x40016bc8 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1073834952")]),t._v("\nebx 0x42130a14 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1108544020")]),t._v("\nesp 0xbffff6a0 0xbffff6a0\nebp 0xbffff6a8 0xbffff6a8\nesi 0x40015360 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1073828704")]),t._v("\nedi 0x80483f0 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("134513648")]),t._v("\neip 0x8048366 0x8048366\neflags 0x386 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("902")]),t._v("\ncs 0x23 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("35")]),t._v("\nss 0x2b "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("43")]),t._v("\nds 0x2b "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("43")]),t._v("\nes 0x2b "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("43")]),t._v("\nfs 0x0 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\ngs 0x33 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("51")]),t._v("\n")])])]),s("p",[t._v("当然也可以显示任意一个指定的寄存器值：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" i r eax\neax 0xbffff6a4 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-1073744220")]),t._v("\n")])])]),s("p",[t._v("最后一个要介绍的命令是“q”，退出（Quit）GDB调试环境：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gdb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" q\nThe program is running. "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v(" anyway? "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("y or n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"补充内容"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#补充内容"}},[t._v("#")]),t._v(" 补充内容")]),t._v(" "),s("blockquote",[s("p",[t._v("gdb 教程："),s("a",{attrs:{href:"http://www.imooc.com/learn/394",target:"_blank",rel:"noopener noreferrer"}},[t._v("慕课网-Linux C语言指针与内存-第三章"),s("OutboundLink")],1)])]),t._v(" "),s("p",[t._v("如果删除源代码, 就无法显示行号等辅助信息了")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("gcc "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-g")]),t._v(" gdb.c "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-o")]),t._v(" gdb.out "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# -g 支持gdb调试; -o 输出, 默认为 a.out")]),t._v("\n\ngdb gdb.out "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 进入 gdb 调试环境")]),t._v("\nenter "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 继续执行上条命令")]),t._v("\nl "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 列出源代码, 默认 10 行, 按 l 继续")]),t._v("\n\nstart "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 开始单步调试, 默认 main() 第一行")]),t._v("\np a "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看 a 变量的值")]),t._v("\nn "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 继续到下一行")]),t._v("\ns "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 进入子函数")]),t._v("\nbt "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看函数栈")]),t._v("\nf "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 切换函数栈")]),t._v("\n\nq 退出调试\n")])])]),s("p",[t._v("测试用代码")]),t._v(" "),s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token macro property"}},[s("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),s("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("<stdio.h>")])]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("change")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" tmp"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    a"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" b"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("tmp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("change2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" tmp"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("b"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("tmp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" a"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("change")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("printf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"change:\\na=%d\\nb=%d\\n"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("change2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("printf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"change2:\\na=%d\\nb=%d\\n"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);