(window.webpackJsonp=window.webpackJsonp||[]).push([[510],{822:function(s,a,t){"use strict";t.r(a);var e=t(14),r=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"scriptreplay"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#scriptreplay"}},[s._v("#")]),s._v(" scriptreplay")]),s._v(" "),a("p",[s._v("重新播放终端会话的所有操作")]),s._v(" "),a("h2",{attrs:{id:"补充说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#补充说明"}},[s._v("#")]),s._v(" 补充说明")]),s._v(" "),a("p",[a("strong",[s._v("scriptreplay")]),s._v(" 用于在终端中，根据 "),a("code",[s._v("script")]),s._v(" 命令记录的终端数据文件和时间日志文件，重现当时用户的所有操作和命令的输出信息。简而言之，重现播放当时终端会话发生的一切信息，而不是重新运行一遍命令。例如，用户当时在输入某条命令时，字符的键入和删除也都会被重现。非常适合用于教程演示场合。而且，在机器 A 上面使用 "),a("code",[s._v("script")]),s._v(" 命令记录终端操作，可以在机器 B 上面使用 "),a("code",[s._v("scriptreplay")]),s._v(" 命令重新播放。")]),s._v(" "),a("h3",{attrs:{id:"语法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#语法"}},[s._v("#")]),s._v(" 语法")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("scriptreplay "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" timingfile "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("typescript "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("divisor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),a("h3",{attrs:{id:"选项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#选项"}},[s._v("#")]),s._v(" 选项")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("-t, "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--timing")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 记录时间日志的文件名称")]),s._v("\n-s, "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--typescript")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 记录终端数据信息的日志文件名称")]),s._v("\n-d, "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--divisor")]),s._v(" number      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 表示倍速播放，把时间日志文件记录的时间间隔都除以 number")]),s._v("\n                          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -d 2 表示播放速度是原始输入单条命令的速度的两倍，-d 0.1 表示播放单条命令的速度减慢 10 倍")]),s._v("\n-m, "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--maxdelay")]),s._v(" number     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 表示命令之间的最大延迟时间（单位是秒）")]),s._v("\n                          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -m 2 表示 command.log 中存放的两条命令之间的间隔时间如果大于两秒，则按两秒执行播放")]),s._v("\n-V, "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--version")]),s._v("             "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示版本信息并退出")]),s._v("\n-h, "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--help")]),s._v("                "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示帮助文本并退出")]),s._v("\n")])])]),a("h3",{attrs:{id:"参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参数"}},[s._v("#")]),s._v(" 参数")]),s._v(" "),a("ul",[a("li",[s._v("时间日志文件：存储时间日志信息的文件名称")]),s._v(" "),a("li",[s._v("终端数据文件：存储终端数据信息的文件名称")])]),s._v(" "),a("h3",{attrs:{id:"实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实例"}},[s._v("#")]),s._v(" 实例")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重新播放终端内容，默认第一个参数是时间日志，第二个参数是终端数据文件")]),s._v("\nscriptreplay time.file command.log\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重新播放终端内容，播放快进速度为 1 ，命令之间最大延时为 2 秒")]),s._v("\nscriptreplay "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" time.file "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" command.log\n")])])]),a("p",[a("strong",[s._v("记录终端内容到文件")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("zfb@localhost:~$ script "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),s._v("time.file "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" command.log\nScript started, "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" is command.log\nzfb@localhost:~$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello, world"')]),s._v("\nhello, world\nzfb@localhost:~$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"+%Y-%m-%d %H:%M:%S"')]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-12-23 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":48:46\nzfb@localhost:~$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Bye"')]),s._v("\nBye\nzfb@localhost:~$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-al")]),s._v("\ntotal "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("\ndrwxr-xr-x  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" zfb zfb "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Dec "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":48 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\ndrwxr-xr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("37")]),s._v(" zfb zfb "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Dec "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":49 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n-rw-r--r--  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" zfb zfb    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" Dec "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":03 a.txt\n-rw-r--r--  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" zfb zfb   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" Dec "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":04 b.txt\n-rw-r--r--  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" zfb zfb "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2744")]),s._v(" Dec "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":49 command.log\n-rw-r--r--  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" zfb zfb  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("790")]),s._v(" Dec "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":49 time.file\nzfb@localhost:~$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\nScript done, "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" is command.log\nzfb@localhost:~$\n")])])]),a("p",[a("strong",[s._v("重新播放终端内容")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("zfb@localhost:~$ scriptreplay "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" time.file "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" command.log\nzfb@localhost:~$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello, world"')]),s._v("\nhello, world\nzfb@localhost:~$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"+%Y-%m-%d %H:%M:%S"')]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-12-23 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":48:46\nzfb@localhost:~$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Bye"')]),s._v("\nBye\nzfb@localhost:~$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-al")]),s._v("\ntotal "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("\ndrwxr-xr-x  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" zfb zfb "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Dec "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":48 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\ndrwxr-xr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("37")]),s._v(" zfb zfb "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Dec "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":49 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n-rw-r--r--  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" zfb zfb    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" Dec "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":03 a.txt\n-rw-r--r--  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" zfb zfb   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" Dec "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":04 b.txt\n-rw-r--r--  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" zfb zfb "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2744")]),s._v(" Dec "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":49 command.log\n-rw-r--r--  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" zfb zfb  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("790")]),s._v(" Dec "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":49 time.file\nzfb@localhost:~$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n\nzfb@localhost:~$\n")])])]),a("p",[s._v("其中，只有命令"),a("code",[s._v("scriptreplay -d 1 -m 2 -t time.file -s command.log")]),s._v("是用户输入，其他均为自动呈现（且视觉效果与真实用户的操作一致）。通过查看上面输出的时间"),a("code",[s._v("2020-12-23 20:48:46")]),s._v("，可以证明，这是重新播放当时的记录，而非重新执行一遍命令。也就是说，可以把"),a("code",[s._v("time.file")]),s._v("和"),a("code",[s._v("command.log")]),s._v("文件移动到任意一台支持"),a("code",[s._v("scriptreplay")]),s._v("命令的机器上，都可以动态重现命令输入与终端回显。")])])}),[],!1,null,null,null);a.default=r.exports}}]);